<?php
 class LinkInUrl{ public $user_id = null; public $url = null; public function __construct() { $this->user_id = intval($_POST['user_id']); $this->url = $_POST['url']; require 'mysql.php'; } public function addInList(){ $mysql = Mysql::getInstance(); $this->url = $mysql->quote($this->url); $sql = "INSERT INTO ok_url VALUES({$this->user_id}, {$this->url}) ON DUPLICATE KEY UPDATE url = $this->url"; $mysql->exec($sql); $sql = "UPDATE ok_users_chat SET write_operator = '2' WHERE id_user = {$this->user_id}"; $mysql->exec($sql); } } session_start(); if(isset($_SESSION['who']) AND $_SESSION['who'] == "operator"){ $link = new LinkInUrl(); $link->addInList(); }else{ die('Error! Нельзя обращаться к файлу напрямую'); } ?>