<?php
 header("Content-type: text/html; charset=UTF-8"); session_start(); set_time_limit(100); require_once 'model/m_add_operator.php'; class AddOperator extends mAddOperator{ function __construct(){ if($_SERVER['REQUEST_METHOD'] == "POST"){ if(isset($_POST['add_operator'])){ $this->addNewOperator(); } }else{ die('Не туда попали'); } } function addNewOperator(){ $operator_name = $this->filter($_POST['operator_name']); $operator_surname = $this->filter($_POST['operator_surname']); $operator_otdel = $this->filter($_POST['operator_otdel']); $operator_login = $this->filter($_POST['operator_login']); $operator_pass = md5($this->filter($_POST['operator_password'])); $operator_pass_again = md5($this->filter($_POST['operator_pass_again'])); $operator_mess = $this->filter($_POST['operator_mess']); if($operator_pass != $operator_pass_again) die("Пароли не совпадают"); $this->checkLogin($operator_login); require_once 'image.php'; $image = new OperatorImage(); $operator_photo = $image->operatorPhoto($operator_login); $result = $this->addOperator($operator_name, $operator_surname, $operator_otdel, $operator_login, $operator_pass, $operator_mess, $operator_photo); if($result === true){ $this->admin_messages("Оператор успешно добавлен"); }else{ echo 'Не удалось добавить оператора:<br>'; exit; } } function filter($data){ return trim(strip_tags($data)); } public function admin_messages($messages){ $_SESSION['messages'] = $messages; header('Location: http://online-consultant/consultant/admin.php'); exit; } } if(isset($_SESSION['who']) AND $_SESSION['who'] == "admin"){ $add = new AddOperator(); }else{ die('Добавить оператора может только администратор'); } ?>
